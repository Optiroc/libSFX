<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Make</title>
<link rel="stylesheet" type="text/css" href="../../styles/main.css">
</head><body class="ContentPage">

<div id=Content><div class="CGroup"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="Make"></a>Make</h1><div class=CBody><p>Building with libSFX involves three major parts∶</p><ul><li>(GNU)Make is invoked and does <a href="https://www.gnu.org/software/make/manual/make.html" class=LURL target=_top>its thing</a> ... which in this case mostly involves:</li><li>Assembling source files to object code files with ca65</li><li>Linking the object code files into an sfc image with ld65</li></ul><p>These three steps are configured with the Makefile, libSFX.cfg and Map.cfg respectively.</p><p>The <a href="https://github.com/Optiroc/libSFX/tree/master/examples/Template" class=LURL target=_top>simplest possible project</a> doesn&rsquo;t need the latter two, as all configurable settings fall back to reasonable defaults.</p><p>Make needs some input, but in the simplest case it&rsquo;s not much∶</p><h4 class=CHeading>Makefile</h4><blockquote><pre># Include libSFX.make
libsfx_dir    := ../..
include $(libsfx_dir)/libSFX.make</pre></blockquote><p>These are the two crucial statements needed to kick off the libSFX.make build script∶</p><ul><li>The &ldquo;libsfx_dir&rdquo; variable must point to the libSFX root directory.</li><li>The second statement includes &ldquo;libSFX.make&rdquo;, which contain the rules needed to transform source files to object code and link the final binary.</li></ul><p>There are also a couple of special configuration variables that was best suited to put in the makefile, mostly because they are needed by both the assembler and the linker.</p><p>The makefile can of course be used like makefiles usually are – to define rules and prerequisites for your particular project.&nbsp; In a lot of cases this will not be necessary for source code files, since libSFX.make will recursively add all source files with the appropriate file extensions (.s, .s700, .sgs) if none are explicitly added.</p><p><b>Configuration variables</b></p><p><u>name</u> Sets the name of the output file.</p><blockquote><pre>name := Mode7-Madness</pre></blockquote><p><u>debug</u> If set debug information ($name.dsym, $name.dmap) will be written.&nbsp; Also, in debug configuration the &ldquo;break&rdquo; macro will output the otherwise unused WDM instruction which is used by the bsnes+ emulator to break the debugger.</p><blockquote><pre>debug := 1</pre></blockquote><p><u>libsfx packages</u> List of optional packages to link, as well as make available to the assembler with additional macros, memory locations et cetera.</p><blockquote><pre>libsfx_packages := LZ4 Mouse</pre></blockquote><p><u>stack size</u> Set space reserved for 65816 stack at memory location 00:2000 and downwards.&nbsp; Default is 100 bytes.</p><blockquote><pre>stack_size := 200</pre></blockquote><p><u>zpad size</u> Set space reserved for zero page scratchpad, addressable at label &ldquo;ZPAD&rdquo;.&nbsp; Default is 10 bytes.</p><blockquote><pre>zpad_size := 20</pre></blockquote><p><u>znmi size</u> Set space reserved for zero page scratchpad for use inside interrupts.&nbsp; Addressable at label &ldquo;ZNMI&rdquo;.&nbsp; Default is 10 bytes.</p><blockquote><pre>znmi_size := 20</pre></blockquote><p><u>rpad size</u> Set space reserved for LORAM scratchpad, addressable at label &ldquo;RPAD&rdquo;.&nbsp; Default is 100 bytes.</p><blockquote><pre>rpad_size := 20</pre></blockquote><p><u>obj dir</u> Set custom directory for intermediate build files.&nbsp; Default is &ldquo;.build&rdquo;.</p><blockquote><pre>obj_dir := build</pre></blockquote><p><u>src</u> 65816 source files.&nbsp; If not set libSFX.make will automatically add all files named *.s.</p><p><u>src smp</u> SPC700 source files.&nbsp; If not set libSFX.make will automatically add all files named *.s700.</p><p><u>src gsu</u> GSU-1 source files.&nbsp; If not set libSFX.make will automatically add all files named *.sgs.</p></div></div></div>

</div><!--Content-->

<div id=Footer>libSFX&nbsp; &middot;&nbsp; <a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->

<div id=Menu><div class=MEntry><div class=MFile><a href="../libSFX-i.html">libSFX documentation</a></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Configuration</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MFile id=MSelected>Make</div></div><div class=MEntry><div class=MFile><a href="../Configurations/libSFX-cfg.html">libSFX.cfg</a></div></div><div class=MEntry><div class=MFile><a href="../Configurations/Map-cfg.html">Map.cfg</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent2')">S-CPU</a><div class=MGroupContent id=MGroupContent2><div class=MEntry><div class=MFile><a href="../CPU-i.html">CPU</a></div></div><div class=MEntry><div class=MFile><a href="../CPU_Def-i.html">CPU_Def</a></div></div><div class=MEntry><div class=MFile><a href="../CPU_Memory-i.html">CPU_Memory</a></div></div><div class=MEntry><div class=MFile><a href="../CPU_Math-i.html">CPU_Math</a></div></div><div class=MEntry><div class=MFile><a href="../CPU_PPU-i.html">CPU_PPU</a></div></div><div class=MEntry><div class=MFile><a href="../CPU_SMP-i.html">CPU_SMP</a></div></div><div class=MEntry><div class=MFile><a href="../CPU_Runtime-i.html">CPU_Runtime</a></div></div><div class=MEntry><div class=MFile><a href="../CPU_DataStructures-i.html">CPU_DataStructures</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent3')">S-SMP</a><div class=MGroupContent id=MGroupContent3><div class=MEntry><div class=MFile><a href="../SMP_Def-i.html">SMP_Def</a></div></div><div class=MEntry><div class=MFile><a href="../SMP_ADSR-i.html">SMP_ADSR</a></div></div><div class=MEntry><div class=MFile><a href="../SMP_Util-i.html">SMP_Util</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent4')">Packages</a><div class=MGroupContent id=MGroupContent4><div class=MEntry><div class=MFile><a href="../Packages/LZ4/LZ4-i.html">LZ4</a></div></div><div class=MEntry><div class=MFile><a href="../Packages/Mouse/Mouse-i.html">Mouse</a></div></div></div></div></div></div><!--Menu-->


<!--START_ND_TOOLTIPS-->
<!--END_ND_TOOLTIPS-->



</body></html>